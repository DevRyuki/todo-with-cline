# アクティブコンテキスト

## 現在の作業焦点
- Todoアプリケーションの基本機能実装
- データベーススキーマとAPIエンドポイントの開発
- フィーチャーモジュール構造の確立
- テスト駆動開発（TDD）の実践とESLintとの連携
- NextAuthを使用した認証機能の実装と改善
- 認証フロントエンドUIの開発

## 最近の変更
- Drizzleを使用したデータベーススキーマの定義
- TodosのCRUD APIエンドポイントの実装
- プロジェクトとワークスペースのスキーマ定義
- フィーチャーベースのディレクトリ構造の導入
- NextAuthを使用した認証バックエンドの実装
- メールアドレス/パスワード認証の実装
- Resendを使用したパスワードリセット機能の実装
- 認証サービスとハンドラーのテスト実装
- パスワード管理用の独立したスキーマの実装
- 認証フロントエンドUIの実装（ログイン、登録、パスワードリセット画面）
- クライアントコンポーネントとサーバーコンポーネントの適切な分離

## 進行中の作業
- フロントエンドUIコンポーネントの開発
- データフェッチングロジックの実装
- プロジェクトとワークスペースのAPIエンドポイント実装
- テスト環境の改善と型定義の最適化

## 次のステップ
1. テストファイルの型エラー解消の最適化
2. Todoリスト表示UIの実装
3. Todo作成・編集フォームの開発
4. プロジェクト管理機能の実装
5. ワークスペース管理機能の実装

## アクティブな決定事項
- **テスト駆動開発（TDD）**: 全ての機能開発において「テスト作成→実装→リファクタリング」のサイクルを採用
- **フィーチャーベースのアーキテクチャ**: 機能ごとにコードを整理し、関連するコンポーネントを一箇所にまとめる
- **Drizzle ORM**: 型安全なSQLクエリビルダーとしてDrizzle ORMを採用
- **Next.js App Router**: ルーティングとAPIエンドポイントの統合のためにApp Routerを使用
- **コンポーネント分離**: UIコンポーネント、データフェッチング、ビジネスロジックの明確な分離
- **NextAuth**: 認証システムとしてNextAuthを採用
- **Resend**: パスワードリセットメール送信にResendを使用

## 現在の課題
- データベースリレーションシップの最適な設計
- フロントエンドとバックエンドの統合テスト戦略
- パフォーマンス最適化の検討
- スケーラビリティを考慮したアーキテクチャの確保
- テストファイルの型エラー解消方法の最適化
- モックオブジェクトの型定義の改善

## 検討中の代替案
- 状態管理: React Context vs Redux vs Zustand
- スタイリング: Tailwind CSS vs CSS Modules vs Styled Components
- フォームバリデーション: React Hook Form vs Formik

## 重要なメモ
- APIエンドポイントは`/api/[resource]`パターンに従う
- データベースマイグレーションは開発中に頻繁に行われる可能性がある
- フィーチャーモジュールは独立して開発・テスト可能であるべき
- UIコンポーネントはレスポンシブデザインを考慮して実装する
- 認証関連のAPIエンドポイント:
  - `/api/auth/[...nextauth]` - NextAuth認証
  - `/api/auth/register` - ユーザー登録
  - `/api/auth/forgot-password` - パスワードリセットリクエスト
  - `/api/auth/reset-password` - パスワードリセット
- テスト環境では型定義ファイル（`jest.d.ts`）を使用してモックオブジェクトの型を定義
- パスワード管理は独立したテーブル（`passwords`）で行い、ユーザーIDで関連付け
